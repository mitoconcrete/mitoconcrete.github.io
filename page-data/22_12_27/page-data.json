{"componentChunkName":"component---src-templates-post-jsx","path":"/22_12_27/","result":{"data":{"site":{"siteMetadata":{"title":"mitoconcrete"}},"markdownRemark":{"id":"4627467c-0323-5342-9723-7fe117c966e7","excerpt":"회고 221227 : 카카오 로그인은 어떻게 동작하지..? 강의 중 OAuth 개념을 배우고 적용해 본 뒤 플로우를 따라가다보니, 이해가 되질 않는 부분이 생겼다. 초기로그인 이후 다시 로그인을 시도했을 때, 카카오톡 로그인 창을 보는것이 아니라 곧바로 메인화면으로 넘어가는 현상이었다. 즉, 처음에만 카카오에게 내 정보를 넘겼는데, 다음부턴 로그인 버튼만…","html":"<h2>[회고] 221227 : 카카오 로그인은 어떻게 동작하지..?</h2>\n<p>강의 중 OAuth 개념을 배우고 적용해 본 뒤 플로우를 따라가다보니, 이해가 되질 않는 부분이 생겼다. 초기로그인 이후 다시 로그인을 시도했을 때, 카카오톡 로그인 창을 보는것이 아니라 곧바로 메인화면으로 넘어가는 현상이었다. 즉, 처음에만 카카오에게 내 정보를 넘겼는데, 다음부턴 로그인 버튼만 눌러도 자동으로 카카오는 내가 '김태훈'이라는 것을 인지하는 현상이었다.\n이 과정이 OAuth의 플로우 중에 어떤 과정에서 일어나는지 도저히 이해되지 않았다.</p>\n<p>카카오 OAuth 의 과정을 간단히 설명하면, 로그인 버튼을 클릭하면, 카카오에서 보내준 인가코드를 내가 설정해 놓은 리다이렉트 api로 전달한다. 나는 이 인가코드를 이용해서 access<em>code 를 받을 수 있고, 이 access</em>code에서 로그인을 시도한 사람의 정보를 가져올 수 있다.</p>\n<p>근데 첫 로그인이야.. 내가 내 이메일과 패스워드를 직접 입력했다고 치고, 그 다음부턴 어떤 일이 일어나기에, 내가 직접입력을 하지 않아도 내 정보를 카카오에서 가져올 수 있는 것일까..?</p>\n<p>몇가지 의심을 해보았다.</p>\n<ol>\n<li>컴퓨터 IP의 정보를 카카오에서 들고있다.\n카카오 DB에서 내 IP의 정보를 들고 있고, 따라서 내가 요청을 했을 때 나인 것을 인지 할 수 있다는 가설이었다.\n하지만, 같은 컴퓨터에서 아내의 계정으로 접속해서 로그인해보았고, 아내의 정보를 잘 불러오는 것을 보았을 땐 이 가설은 절대 성립 할 수 없음을 깨달았다.</li>\n<li>\n<p>인가코드를 통해 구분을 한다..?\naccess_code에서는 내 정보를 뽑아오기 때문에, 뭔가 리다이렉 api 에 전달되는 인가코드가 나를 인지하는 트리거가 되지 않을까? 하는 가설을 해보았다.\n나는 처음에 인가코드가 카카오 개발자에서 보낸 REST API KEY에만 종속되어있다고 생각하여, 저 키가 변하지 않는 이상 계속 같은 코드가 오지 않을까? 생각했다.\n하지만, 실험을 해보니, 로그인 마다 매번 다른 인가코드가 전달되어 오고 있었다.</p>\n<p><img src=\"/image/221227_01.png\" alt=\"1차실험\">\n<img src=\"/image/221227_02.png\" alt=\"2차실험\"></p>\n<p>그렇다는 것은 현재 이 브라우저 어딘가에, 나를 인지 할 수 있는 어떤 값이 숨어있고 그것을 리다이렉트 요청 시에 같이 보내고 있다는 것인데.. 그것이 어디있는지 추적하다보니 요청헤더에 쿠키값이 포함되어 가는 것을 발견 할 수 있었다. 하지만, 브라우저 어디에서도 이 값들이 어디에 셋팅되어 있는지 찾을 수 없었다.\n그러다, zep에서 쿠키문제로 고생했던 경험이 떠올랐고, 그 때도 브라우저 어플리케이션 탭의 쿠키에서 찾을 수 없던 것들을 볼 수 있었던 경험을 되살려 동일한 방법으로 쿠키를 찾아보았다.\n그랬더니..</p>\n<p><img src=\"/image/221227_03.png\" alt=\"카카오쿠키발견\"></p>\n<p>드디어 발견했다. 로그인 시, 이정보들을 보내주는 것 이었다. 하지만 새로고침 시 이 정보들은 모두 사라졌는데, 쿠키의 정보는 데스크탑에 저장되는 것을 알고 있어서 찾아보니, <code class=\"language-text\">~/Library/Application Support/Google/Chrome/</code> 의 경로에 각각 브라우저에 대한 <code class=\"language-text\">Profile</code> 이 있고, 그에 따른 쿠키들이 <code class=\"language-text\">Cookies</code>라는 이름으로 저장되어 있었다. hex code로 변환해서 까보니, kakao에 대한 쿠키를 발견 할 수 있었다.</p>\n</li>\n</ol>\n<p>이로서 알아낸 것은 초기 로그인 시, 카카오는 브라우저에 유저를 인증 할 수 있는 쿠키를 저장하고, 로그인 시도 시 쿠키값이 있다면 함께보내주어 리다이렉트 url에 해당유저에 대한 인가코드를 전달하여 1차적으로 이 유저에 대한 권한을 인가한다는 것 이었다.</p>\n<p>위의 경험을 트래킹하는 과정에서 OAuth의 플로우를 전반적으로 살펴 볼 수 있었고, 그에따라 이전에는 계속이해가 가지않았던 플로우에 대해서 조금더 이해 할 수 있는 시간이 되어서 좋았다.</p>\n<h2>[TodayKeywords] 오늘 공부한 키워드</h2>\n<ul>\n<li><code class=\"language-text\">스프링 시큐리티의 세션</code> : 스프링 시큐리티는 기본적으로 쿠키-세션 방식을 지향한다. 따라서, JWT를 사용하기 위해선 이 설정을 끄고 진행해주어야한다.</li>\n<li><code class=\"language-text\">블랙박스 테스팅</code> : 내부의 동작을 모르는 다수의 인원이 기능을 테스트 하는 것이다.</li>\n<li><code class=\"language-text\">개발자 테스팅</code> : 개발자가 자신이 작성한 코드를 테스트 하는 것이다.</li>\n<li><code class=\"language-text\">TDD</code> : 테스트 주도 개발은 테스트를 먼저 작성하고 개발을 진행하는 방식이다. Given(준비) -> When(실행) -> Then(검즘) 방식이 있다.</li>\n<li><code class=\"language-text\">@Mock vs @InjectMocks</code> : 실제 Service, Controller, Entity 등을 사용하면, 실제서비스에 영향이 갈 수 있기 때문에 목업 컴포넌트들을 만들 수 있다. <code class=\"language-text\">@Mock</code>은 컴포넌트의 복사본이고, <code class=\"language-text\">@InjectMocks</code>는 동일한 복사복이지만, <code class=\"language-text\">@Mock</code> 들이 DI된 컴포넌트이다.</li>\n<li><code class=\"language-text\">AOP JointPoint</code> : JointPoint 는 핵심로직을 의미한다. aop는 핵심로직의 전 후에서 실행되기 때문에, 이 시점을 관리하기 위해서 jointPoint 라는 매개변수를 넘겨받아 AOP의 실행시점을 정해준다.</li>\n<li><code class=\"language-text\">PointCut Expression</code> : AOP의 어드바이스가 어느 컴포넌트에서 실행되야 할지 위치를 지정해준다.</li>\n<li><code class=\"language-text\">@PointCut</code> : Expression 의 재사용 및 조합이 가능해진다.</li>\n<li><code class=\"language-text\">@Transactional</code> : AOP이다. 트랜잭션이 플러시 되거나 롤백되는것은 유저의 핵심관심사가 아니다, 이것은 백업에서 해주어야 할 서브관심사로서, AOP단계에서 동작한다.</li>\n<li><code class=\"language-text\">Primary &amp; Replica</code> : 트랜젝션의 ACID원칙을 지키기 위해 DB를 읽기전용, 쓰기전용으로 나눠쓰는 방식을 말한다. <code class=\"language-text\">@Transactional(readOnly=true)</code> 를 쓰게되면, 읽기전용 DB로 요청이 가게 된다. 따라서, DB를 한개만 사용할 땐 readOnly를 활성화하는 것은 큰 의미가 없다.</li>\n</ul>\n<h2>[NextKeyworks] Study Queue</h2>\n<ul>\n<li>HTTPS</li>\n<li>SOLID</li>\n<li>loop label</li>\n<li>CSV</li>\n<li>파일입출력</li>\n<li>UML</li>\n<li>UTC</li>\n<li>epoch time / Instant time</li>\n<li>MVC</li>\n<li>URL ClassLoader</li>\n<li>Secure ClassLoader</li>\n<li>JNI</li>\n<li>GC</li>\n<li>HOF</li>\n<li>자바 해시코드(hashCode)</li>\n<li>OSI 7 계층</li>\n<li>PCB</li>\n<li>스프링 설계철학</li>\n<li>RESTful</li>\n<li>준 영속성</li>\n<li>지연로딩</li>\n<li>프록시객체</li>\n<li>jpa - mybatis 의 차이</li>\n<li>orm - mapper 의 차이</li>\n<li>쿠키/세션/로컬 스토리지</li>\n<li>HttpMessageConverter</li>\n<li>서블릿</li>\n<li>ACID</li>\n</ul>","frontmatter":{"title":"✏️ 2022-12-27 Today I Learn","date":"December 27, 2022","update":"December 27, 2022","tags":["Spring","TIL","내일배움캠프","스파르타코딩캠프"],"series":"내일배움캠프"},"fields":{"slug":"/22_12_27/","readingTime":{"minutes":9.125}}},"seriesList":{"edges":[{"node":{"id":"1d145774-0c36-5571-8c1c-90522f062fb7","fields":{"slug":"/23_01_1st/"},"frontmatter":{"title":"✏️ 2023-01-1st Weekly I Learn"}}},{"node":{"id":"bff90a25-d0a7-5c7f-a6fb-bf15787a70dc","fields":{"slug":"/22_10_31/"},"frontmatter":{"title":"✏️ 2022-10-31 Today I Learn"}}},{"node":{"id":"68eb6c50-88e2-5afe-9bc0-7e1673e0ea6d","fields":{"slug":"/22_11_01/"},"frontmatter":{"title":"✏️ 2022-11-01 Today I Learn"}}},{"node":{"id":"6b664f20-f21b-5678-84b3-3959827dc922","fields":{"slug":"/22_11_02/"},"frontmatter":{"title":"✏️ 2022-11-02 Today I Learn"}}},{"node":{"id":"2af6e2bd-2fff-52cb-80cc-ffab51e8f899","fields":{"slug":"/22_11_03/"},"frontmatter":{"title":"✏️ 2022-11-03 Today I Learn"}}},{"node":{"id":"2beec6d7-e058-5f0d-ae30-d2012c7d16ea","fields":{"slug":"/22_11_04/"},"frontmatter":{"title":"✏️ 2022-11-04 Today I Learn"}}},{"node":{"id":"9fa2d0ab-5bb6-5e0e-8499-e69a7839c45f","fields":{"slug":"/22_11_1st/"},"frontmatter":{"title":"✏️ 2022-11-1st Weekly I Learn"}}},{"node":{"id":"f527c43e-29f4-5073-8ad4-ab7da0f3977f","fields":{"slug":"/22_11_07/"},"frontmatter":{"title":"✏️ 2022-11-07 Today I Learn"}}},{"node":{"id":"2cbe19b7-ed66-54b7-9a88-0fcc3cf6c153","fields":{"slug":"/22_11_08/"},"frontmatter":{"title":"✏️ 2022-11-08 Today I Learn"}}},{"node":{"id":"78126d6d-cf07-5526-a5e3-87239126f815","fields":{"slug":"/22_11_09/"},"frontmatter":{"title":"✏️ 2022-11-09 Today I Learn"}}},{"node":{"id":"692e8305-8db0-5580-a7f8-e43fefc02bd3","fields":{"slug":"/22_11_10/"},"frontmatter":{"title":"✏️ 2022-11-10 Today I Learn"}}},{"node":{"id":"514df56a-8dfc-5f59-8656-3c77a1e4327d","fields":{"slug":"/22_11_11/"},"frontmatter":{"title":"✏️ 2022-11-11 Today I Learn"}}},{"node":{"id":"dde9725a-6731-564e-8374-01317f8fb11f","fields":{"slug":"/22_11_2nd/"},"frontmatter":{"title":"✏️ 2022-11-2nd Weekly I Learn"}}},{"node":{"id":"97db2986-14ad-59dd-b32c-6b448d5a733e","fields":{"slug":"/22_11_14/"},"frontmatter":{"title":"✏️ 2022-11-14 Today I Learn"}}},{"node":{"id":"df8dd86e-3071-59c1-a092-288a3c90807e","fields":{"slug":"/22_11_15/"},"frontmatter":{"title":"✏️ 2022-11-15 Today I Learn"}}},{"node":{"id":"b02be35b-96ec-51b5-9ae2-23820778b8d8","fields":{"slug":"/22_11_16/"},"frontmatter":{"title":"✏️ 2022-11-16 Today I Learn"}}},{"node":{"id":"a2f18918-5486-599c-a969-ebe995817f9f","fields":{"slug":"/22_11_17/"},"frontmatter":{"title":"✏️ 2022-11-17 Today I Learn"}}},{"node":{"id":"c7d1adcc-ea6d-5273-ace8-c3d1819c89a9","fields":{"slug":"/22_11_18/"},"frontmatter":{"title":"✏️ 2022-11-18 Today I Learn"}}},{"node":{"id":"3222dd56-1dea-5052-81d7-7898798e0238","fields":{"slug":"/22_11_3rd/"},"frontmatter":{"title":"✏️ 2022-11-3rd Weekly I Learn"}}},{"node":{"id":"7617e852-4a75-5a03-8baf-fb255eb554f9","fields":{"slug":"/22_11_21/"},"frontmatter":{"title":"✏️ 2022-11-21 Today I Learn"}}},{"node":{"id":"9f104791-a2d7-50b6-80b5-e78bd5ec7678","fields":{"slug":"/22_11_22/"},"frontmatter":{"title":"✏️ 2022-11-22 Today I Learn"}}},{"node":{"id":"6205256b-a876-5a1e-94bf-9dc15065a965","fields":{"slug":"/22_11_23/"},"frontmatter":{"title":"✏️ 2022-11-23 Today I Learn"}}},{"node":{"id":"4db78a29-3441-5206-8002-6e7321bb7c99","fields":{"slug":"/22_11_24/"},"frontmatter":{"title":"✏️ 2022-11-24 Today I Learn"}}},{"node":{"id":"4adfbcd8-9d66-5c5d-ab31-71005a65cd14","fields":{"slug":"/22_11_25/"},"frontmatter":{"title":"✏️ 2022-11-25 Today I Learn"}}},{"node":{"id":"65a2f128-15ee-5853-a4c3-115eb93af8f2","fields":{"slug":"/22_11_4th/"},"frontmatter":{"title":"✏️ 2022-11-4th Weekly I Learn"}}},{"node":{"id":"6474759c-b861-5e6d-bcd3-1dc4d4fb6050","fields":{"slug":"/22_11_28/"},"frontmatter":{"title":"✏️ 2022-11-28 Today I Learn"}}},{"node":{"id":"a9471a01-6814-534f-8f42-7bb167e939f9","fields":{"slug":"/22_11_29/"},"frontmatter":{"title":"✏️ 2022-11-29 Today I Learn"}}},{"node":{"id":"55a96c56-95ce-5ddd-902f-74879ef03e7d","fields":{"slug":"/22_11_30/"},"frontmatter":{"title":"✏️ 2022-11-30 Today I Learn"}}},{"node":{"id":"e421a9be-d87d-507b-b2ec-653f9b0ab722","fields":{"slug":"/22_12_01/"},"frontmatter":{"title":"✏️ 2022-12-01 Today I Learn"}}},{"node":{"id":"004d92cd-c4ab-57f0-a1f2-29ddf364e409","fields":{"slug":"/22_12_02/"},"frontmatter":{"title":"✏️ 2022-12-02 Today I Learn"}}},{"node":{"id":"bcf2f7af-4ba3-59b7-83dd-d5376cf5aa36","fields":{"slug":"/22_12_1st/"},"frontmatter":{"title":"✏️ 2022-12-1th Weekly I Learn"}}},{"node":{"id":"d247bb1b-dcca-5f7a-951c-6c2a803db140","fields":{"slug":"/22_12_05/"},"frontmatter":{"title":"✏️ 2022-12-05 Today I Learn"}}},{"node":{"id":"776f9c88-4455-53f4-ae90-e7754918558a","fields":{"slug":"/22_12_06/"},"frontmatter":{"title":"✏️ 2022-12-06 Today I Learn"}}},{"node":{"id":"c6b17078-0525-5ec8-80ee-0b9fa2e0227d","fields":{"slug":"/22_12_07/"},"frontmatter":{"title":"✏️ 2022-12-07 Today I Learn"}}},{"node":{"id":"e7f37c40-c448-573d-80ee-a87e7f25485d","fields":{"slug":"/22_12_08/"},"frontmatter":{"title":"✏️ 2022-12-08 Today I Learn"}}},{"node":{"id":"29d073f0-0b07-5b80-9e0f-d5bfb9de98b5","fields":{"slug":"/22_12_09/"},"frontmatter":{"title":"✏️ 2022-12-09 Today I Learn"}}},{"node":{"id":"a8d8ef79-c35e-5a8b-a1c9-accfa950cbc9","fields":{"slug":"/22_12_2nd/"},"frontmatter":{"title":"✏️ 2022-12-2nd Weekly I Learn"}}},{"node":{"id":"4252e767-57a3-5105-a02f-7cfc836d0e6a","fields":{"slug":"/22_12_12/"},"frontmatter":{"title":"✏️ 2022-12-12 Today I Learn"}}},{"node":{"id":"aa13b33f-cfd2-5c84-9933-faa53b0c707b","fields":{"slug":"/22_12_13/"},"frontmatter":{"title":"✏️ 2022-12-13 Today I Learn"}}},{"node":{"id":"7d26c70f-0213-5152-91d8-c6e17ed0c77c","fields":{"slug":"/22_12_14/"},"frontmatter":{"title":"✏️ 2022-12-14 Today I Learn"}}},{"node":{"id":"0a14e2fa-df2b-5d4e-b49f-bc200ddf34e8","fields":{"slug":"/22_12_15/"},"frontmatter":{"title":"✏️ 2022-12-15 Today I Learn"}}},{"node":{"id":"497abc88-2ebb-5f02-8a15-7f8ec4bb19c3","fields":{"slug":"/22_12_16/"},"frontmatter":{"title":"✏️ 2022-12-16 Today I Learn"}}},{"node":{"id":"c3e1b3d6-bab1-5ccc-9cb9-e97c50ce04d8","fields":{"slug":"/22_12_3rd/"},"frontmatter":{"title":"✏️ 2022-12-3rd Weekly I Learn"}}},{"node":{"id":"8a7fcec3-5344-5298-8f9b-5d6f3fc601d0","fields":{"slug":"/22_12_19/"},"frontmatter":{"title":"✏️ 2022-12-19 Today I Learn"}}},{"node":{"id":"00e08244-1e45-57e7-8914-79729e10c2c2","fields":{"slug":"/22_12_20/"},"frontmatter":{"title":"✏️ 2022-12-20 Today I Learn"}}},{"node":{"id":"afff2d03-2396-5e52-89d5-6da63e7b29d3","fields":{"slug":"/22_12_21/"},"frontmatter":{"title":"✏️ 2022-12-21 Today I Learn"}}},{"node":{"id":"8b77f9b7-35a4-50d1-b220-efaeac19ecfe","fields":{"slug":"/22_12_22/"},"frontmatter":{"title":"✏️ 2022-12-22 Today I Learn"}}},{"node":{"id":"f924b607-0e05-5991-a601-36775ed1ad62","fields":{"slug":"/22_12_23/"},"frontmatter":{"title":"✏️ 2022-12-23 Today I Learn"}}},{"node":{"id":"fec859b1-91c9-5b74-9dbd-a0c0a65e299b","fields":{"slug":"/22_12_4th/"},"frontmatter":{"title":"✏️ 2022-12-4th Weekly I Learn"}}},{"node":{"id":"002d301b-53a2-5797-bda2-4197e25cf175","fields":{"slug":"/22_12_26/"},"frontmatter":{"title":"✏️ 2022-12-26 Today I Learn"}}},{"node":{"id":"4627467c-0323-5342-9723-7fe117c966e7","fields":{"slug":"/22_12_27/"},"frontmatter":{"title":"✏️ 2022-12-27 Today I Learn"}}},{"node":{"id":"da9cc9b4-ba58-5a4d-a432-5604c400243d","fields":{"slug":"/22_12_28/"},"frontmatter":{"title":"✏️ 2022-12-28 Today I Learn"}}},{"node":{"id":"c45dbf3b-84b6-513a-b91f-00d3831a2feb","fields":{"slug":"/22_12_29/"},"frontmatter":{"title":"✏️ 2022-12-29 Today I Learn"}}},{"node":{"id":"54168b06-a8bd-5d1f-ab5f-b5b3e74cf3d1","fields":{"slug":"/22_12_30/"},"frontmatter":{"title":"✏️ 2022-12-30 Today I Learn"}}},{"node":{"id":"f8430001-1221-5721-8c46-798887bb6d47","fields":{"slug":"/23_01_05/"},"frontmatter":{"title":"✏️ 2023-01-05 Today I Learn"}}},{"node":{"id":"05dc93e3-b440-525b-abf5-ca213641dbe5","fields":{"slug":"/23_01_06/"},"frontmatter":{"title":"✏️ 2023-01-06 Today I Learn"}}}]},"previous":{"fields":{"slug":"/22_12_26/"},"frontmatter":{"title":"✏️ 2022-12-26 Today I Learn"}},"next":{"fields":{"slug":"/22_12_28/"},"frontmatter":{"title":"✏️ 2022-12-28 Today I Learn"}}},"pageContext":{"id":"4627467c-0323-5342-9723-7fe117c966e7","series":"내일배움캠프","previousPostId":"002d301b-53a2-5797-bda2-4197e25cf175","nextPostId":"da9cc9b4-ba58-5a4d-a432-5604c400243d"}},"staticQueryHashes":[]}